<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Stats Tracker - Control Voley</title><link rel="manifest" href="manifest.json"><meta name="theme-color" content="#001F3F"><script src="https://cdn.tailwindcss.com"></script><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet"><script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script><style>:root{--bg:#F7F8FA;--card:#fff;--dark:#1f2937;--blue:#0056FF;--red:#dc2626;--row:#f3f4f6}body{font-family:Inter,sans-serif;user-select:none;background:var(--bg)}.card{background:var(--card);color:var(--dark);border:1px solid #d1d5db;transition:all .2s;box-shadow:0 4px 10px -1px rgba(0,86,255,.1)}.card:hover{transform:translateY(-2px)}.toast-notification{position:fixed;bottom:2rem;left:50%;transform:translateX(-50%);background:#1f2937;color:#fff;padding:.75rem 1.5rem;border-radius:.5rem;z-index:9999;opacity:0;transition:opacity .3s;pointer-events:none}.toast-visible{opacity:1}input::-webkit-inner-spin-button,input::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}</style></head><body class="text-gray-800 min-h-screen p-4"><main class="w-full max-w-5xl mx-auto space-y-8"><header class="text-center relative"><a href="index_menu.html" class="absolute top-0 right-0 font-bold py-2 px-4 rounded-md text-sm text-white bg-[#0056FF] shadow-md">Menú</a><h1 class="text-4xl font-extrabold sm:text-5xl">Control Voley <span class="text-yellow-600">Stats</span></h1><p class="mt-4 text-gray-500 font-medium">Rendimiento en tiempo real.</p></header><div class="grid grid-cols-1 gap-8"><div class="space-y-6"><div class="card p-6 rounded-lg"><h2 class="text-2xl font-semibold mb-4 border-b border-[#0056FF] text-[#0056FF]">Atleta</h2><div class="flex flex-col sm:flex-row gap-4"><input id="pNum" placeholder="Nro." class="w-full sm:w-24 border p-2 rounded" type="number"><input id="pNam" placeholder="Nombre" class="flex-grow border p-2 rounded" type="text"><button id="addP" class="bg-[#0056FF] text-white font-bold py-2 px-4 rounded shadow-lg">Agregar</button></div></div><div class="card p-6 rounded-lg"><h2 class="text-2xl font-semibold mb-4 border-b border-[#0056FF] text-[#0056FF]">Acción</h2><form id="aFrm" class="space-y-4"><select id="pSel" class="w-full border p-2 rounded"><option disabled selected>Agregar atleta primero</option></select><select id="aSel" class="w-full border p-2 rounded"></select><button type="submit" class="w-full bg-[#0056FF] text-white font-bold py-2 rounded shadow-lg">Registrar</button><div class="grid grid-cols-2 gap-2"><button type="button" id="cSet" class="bg-amber-600 text-white font-bold py-2 rounded">Reiniciar Set</button><button type="button" id="cGam" class="bg-red-600 text-white font-bold py-2 rounded">Borrar Todo</button></div></form></div></div><div class="card p-6 rounded-lg"><h2 class="text-2xl font-semibold mb-4 border-b border-[#0056FF] text-[#0056FF]">Estadística</h2><div id="sCont" class="space-y-3"></div></div><div class="card p-6 rounded-lg h-80"><canvas id="bChrt"></canvas></div><div class="card p-6 rounded-lg h-80"><canvas id="aChrt"></canvas><div id="tSum" class="text-center mt-4 font-bold text-sm"></div></div></div></main><script>(function(){let bC=null,aC=null,L=[],M=[],S=[];const N={'Servicio Bueno S#':1,'Ataque Bueno A#':1,'Bloqueo Bueno B#':1,'Coloque Bueno C#':1,'Servicio Malo S=':-1,'Ataque Malo A=':-1,'Bloqueo Malo B=':-1,'Recepción Mala R=':-1,'Coloque Malo C=':-1,'Defensa Mala D=':-1},O={S:'Servicio',A:'Ataque',B:'Bloqueo',R:'Recepción',C:'Coloque',D:'Defensa'},P={b:'#0056FF',r:'#dc2626',o:'#f97316',g:'#10b981'};const _=(id)=>document.getElementById(id);function toast(m){const t=document.createElement('div');t.className='toast-notification';t.textContent=m;document.body.appendChild(t);setTimeout(()=>t.classList.add('toast-visible'),10);setTimeout(()=>{t.classList.remove('toast-visible');setTimeout(()=>t.remove(),300)},2000)}function save(){localStorage.setItem('vP',JSON.stringify(L));localStorage.setItem('vM',JSON.stringify(M));localStorage.setItem('vS',JSON.stringify(S))}function load(){L=JSON.parse(localStorage.getItem('vP')||'[]');M=JSON.parse(localStorage.getItem('vM')||'[]');S=JSON.parse(localStorage.getItem('vS')||'[]')}function upd(){const sc=_('sCont');sc.innerHTML='';if(!L.length){sc.innerHTML='<p class="text-center py-4">Sin atletas</p>';return}let pSt={};L.forEach(p=>pSt[p.number]={p:0,n:0,a:{}});S.forEach(l=>{let st=pSt[l.playerNumber];if(st){let v=N[l.action],t=l.action.charAt(l.action.length-2);v>0?st.p++:st.n++;if(!st.a[t])st.a[t]={p:0,n:0};v>0?st.a[t].p++:st.a[t].n++}});L.forEach(p=>{let st=pSt[p.number],diff=st.p-st.n,det='';Object.keys(st.a).forEach(k=>det+=`<span class="mr-2">${k}:${st.a[k].p}|${st.a[k].n}</span>`);sc.innerHTML+=`<div class="bg-gray-100 p-2 rounded mb-2 text-sm"><div class="flex justify-between font-bold"><span>#${p.number} ${p.name}</span><span>Dif: ${diff}</span></div><div class="text-[10px] text-gray-500">${det}</div></div>`});chartUpdate()}function chartUpdate(){const ctxB=_('bChrt').getContext('2d'),ctxA=_('aChrt').getContext('2d');let bD={p:[],n:[],l:Object.values(O)};Object.keys(O).forEach(k=>{let p=0,n=0;S.forEach(l=>{if(l.action.charAt(l.action.length-2)===k){N[l.action]>0?p++:n++}});bD.p.push(p);bD.n.push(n)});if(bC)bC.destroy();bC=new Chart(ctxB,{type:'bar',data:{labels:bD.l,datasets:[{label:'+',data:bD.p,backgroundColor:P.b},{label:'-',data:bD.n,backgroundColor:P.o}]},options:{responsive:true,maintainAspectRatio:false}});let aD={p:[],n:[],l:Object.values(O)},tp=0,tn=0;Object.keys(O).forEach(k=>{let p=0,n=0;M.forEach(l=>{if(l.action.charAt(l.action.length-2)===k){N[l.action]>0?(p++,tp++):(n++,tn++)}});aD.p.push(p);aD.n.push(n)});_('tSum').innerHTML=`Total Pos: ${tp} | Neg: ${tn}`;if(aC)aC.destroy();aC=new Chart(ctxA,{type:'bar',data:{labels:aD.l,datasets:[{label:'Pos',data:aD.p,backgroundColor:P.g},{label:'Neg',data:aD.r,backgroundColor:P.o}]},options:{responsive:true,maintainAspectRatio:false}})}document.addEventListener('DOMContentLoaded',()=>{load();const ps=_('pSel'),as=_('aSel');function pP(){ps.innerHTML='';L.sort((a,b)=>a.number-b.number).forEach(p=>{let o=document.createElement('option');o.value=p.number;o.textContent=`#${p.number} ${p.name}`;ps.appendChild(o)})}function pA(){as.innerHTML='';Object.keys(N).forEach(k=>{let o=document.createElement('option');o.value=k;o.textContent=k;as.appendChild(o)})} _('addP').onclick=()=>{let n=parseInt(_('pNum').value),m=_('pNam').value;if(n&&m){L.push({number:n,name:m});save();pP();upd();_('pNum').value='';_('pNam').value='';toast('Agregado')}};_('aFrm').onsubmit=(e)=>{e.preventDefault();let p=parseInt(ps.value),a=as.value;if(p){let l={playerNumber:p,action:a};M.push(l);S.push(l);save();upd();toast('Ok')}};_('cSet').onclick=()=>{if(confirm('Reiniciar Set?')){S=[];save();upd();toast('Set 0')}};_('cGam').onclick=()=>{if(confirm('Borrar todo?')){localStorage.clear();location.reload()}};pP();pA();upd()});if('serviceWorker'in navigator){window.addEventListener('load',()=>{navigator.serviceWorker.register('./sw.js')})}})()</script></body></html>
