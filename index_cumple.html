<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cumplea침os del Mes - Control Voley</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'voley-blue': '#1e40af', // Azul fuerte (Blue 800)
                        'voley-dark': '#1e3a8a', // Azul oscuro (Blue 900)
                        'voley-light': '#eff6ff', // Azul muy claro (Blue 50)
                        'voley-gold': '#f59e0b', // Oro/Amarillo para cumplea침os (Amber 500)
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        /* Estilo general del fondo */
        .hero-section {
            background-image: url('https://placehold.co/1920x1080/0e1b3e/ffffff?text=Voleibol');
            background-size: cover;
            background-position: center;
            position: relative;
            z-index: 0;
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            /* Degradado m치s suave para la lista */
            background: linear-gradient(135deg, rgba(30, 64, 175, 0.9) 0%, rgba(30, 64, 175, 0.7) 100%);
            z-index: -1;
        }
    </style>
</head>
<body class="bg-voley-light font-sans min-h-screen flex flex-col items-center">

    <section class="hero-section w-full flex-grow flex flex-col items-center justify-start py-16 px-4 sm:px-6 lg:px-8">
        
        <div class="w-full max-w-4xl fixed top-0 left-1/2 transform -translate-x-1/2 p-4 flex justify-between items-center bg-voley-dark/80 rounded-b-lg backdrop-blur-sm shadow-2xl z-10">
            <div class="flex items-center">
                <span class="text-sm sm:text-lg font-medium text-white/90 mr-3 hidden sm:inline">Club Activo:</span>
                <span id="currentClubDisplay" class="text-base sm:text-xl font-bold text-voley-light py-1 px-3 bg-voley-blue rounded-full shadow-md">Cargando...</span>
            </div>

            <a href="index_menu.html" class="py-2 px-3 sm:py-2 sm:px-4 bg-voley-blue text-white font-semibold rounded-lg text-sm sm:text-base hover:bg-voley-dark transition duration-200 flex items-center shadow-md mr-4">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 sm:h-5 sm:w-5 mr-1 sm:mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                </svg>
                Men칰
            </a>

            <button id="logoutButton" class="py-2 px-3 sm:py-2 sm:px-4 bg-red-600 text-white font-semibold rounded-lg text-sm sm:text-base hover:bg-red-700 transition duration-200 flex items-center shadow-md">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 sm:h-5 sm:w-5 mr-1 sm:mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                </svg>
                Salir
            </button>
        </div>

        <div class="pt-24 max-w-4xl w-full">
            
            <h1 class="text-4xl font-extrabold text-white text-center mb-8 drop-shadow-lg">
                Cumplea침os del Mes
            </h1>
            
            <div class="w-full text-center p-8 md:p-12 rounded-xl shadow-2xl bg-white/90 border border-white/20 relative">
                
                <h2 class="text-2xl sm:text-3xl font-bold text-voley-dark mb-6">
                    Atletas de <span id="clubTitleDisplay">Cargando...</span>
                </h2>
                
                <div id="cumpleanosList" class="space-y-4 text-left">
                    </div>
                
                <p id="loadingMessage" class="text-center text-gray-500 mt-8 text-lg">Cargando lista de cumplea침eros...</p>
            </div>
        </div>
    </section>

    <footer class="w-full py-4 text-center bg-voley-dark shadow-inner">
        <p class="text-sm text-white/70">
            &copy; 2023 Todos los derechos reservados a Sistematikos - Frank Hernandez
        </p>
    </footer>

    <script>
        const currentClubDisplay = document.getElementById('currentClubDisplay');
        const clubTitleDisplay = document.getElementById('clubTitleDisplay');
        const logoutButton = document.getElementById('logoutButton');
        const cumpleanosList = document.getElementById('cumpleanosList');
        const loadingMessage = document.getElementById('loadingMessage');

        /**
         * 1. L칩gica de Sesi칩n y Redirecci칩n
         */
        const currentClubName = localStorage.getItem('currentClub');

        if (currentClubName && currentClubName !== 'null') {
            currentClubDisplay.textContent = currentClubName;
            clubTitleDisplay.textContent = currentClubName;
            // Si hay sesi칩n, cargar los datos
            loadBirthdays(currentClubName);
        } else {
            // Redirigir si no hay club para evitar acceso no autorizado
            currentClubDisplay.textContent = 'Acceso Denegado';
            clubTitleDisplay.textContent = 'Club Desconocido';
            console.warn('No se encontr칩 club en localStorage. Redirigiendo a login.');
            loadingMessage.textContent = 'Acceso denegado. Redirigiendo...';
            setTimeout(() => {
                window.location.href = 'index.html'; 
            }, 1000);
        }

        /**
         * 2. Funci칩n para cerrar sesi칩n.
         */
        logoutButton.addEventListener('click', () => {
            localStorage.removeItem('currentClub'); 
            window.location.href = 'index.html'; 
        });

        /**
         * 3. Bloquear el clic derecho (Men칰 contextual)
         */
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
        });
        
        /**
         * 4. FUNCI칍N CLAVE: CARGAR CUMPLEA칌OS FILTRADOS POR CLUB
         * * 丘멆잺 ESTO ES UN MARCADOR DE POSICI칍N. DEBES REEMPLAZAR LA L칍GICA INTERNA 
         * CON TU IMPLEMENTACI칍N REAL DE FIRESTORE.
         */
        async function loadBirthdays(clubName) {
            loadingMessage.classList.remove('hidden');
            cumpleanosList.innerHTML = ''; // Limpiar lista

            // --------------------------------------------------------------------------------
            // 游늷 COMIENZA LA ZONA DE PERSONALIZACI칍N DE BASE DE DATOS (FIREBASE/FIRESTORE)
            // --------------------------------------------------------------------------------

            // 1. Obtener el mes actual para filtrar
            const currentMonth = new Date().getMonth() + 1; // getMonth() es 0-index (Enero=0)
            const monthNames = ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"];
            loadingMessage.textContent = `Buscando cumplea침os en ${monthNames[currentMonth - 1]} para el club ${clubName}...`;

            try {
                // 
                // ** EJEMPLO DE L칍GICA CON DATOS DE PRUEBA (Reemplazar con tu c칩digo Firebase)  **
                // 
                
                // Simulaci칩n de datos filtrados por club y mes
                const allAthletesData = [
                    // Datos para el club logueado (Ej: Fenix) y el mes actual (Ej: Diciembre = 12)
                    { nombre: "Ana P칠rez", fechaNacimiento: `2000-${currentMonth}-15`, club: "Fenix" },
                    { nombre: "Luis Soto", fechaNacimiento: `1998-${currentMonth}-02`, club: "Fenix" },
                    
                    // Datos de otros clubes (NO deber칤an mostrarse)
                    { nombre: "Pedro G칩mez", fechaNacimiento: `1995-${currentMonth}-20`, club: "San Benito" },
                    { nombre: "Elena Ruiz", fechaNacimiento: "2001-11-25", club: "Fenix" }, // Mes diferente
                ];

                // FILTRADO DE PRUEBA (T칰 har칤as este filtro directamente con una consulta a Firestore)
                const filteredBirthdays = allAthletesData.filter(athlete => {
                    const athleteMonth = new Date(athlete.fechaNacimiento).getMonth() + 1;
                    return athlete.club === clubName && athleteMonth === currentMonth;
                });
                
                // 
                // ** FIN DEL EJEMPLO DE DATOS DE PRUEBA **
                // 
                
                if (filteredBirthdays.length > 0) {
                    filteredBirthdays.sort((a, b) => new Date(a.fechaNacimiento).getDate() - new Date(b.fechaNacimiento).getDate());

                    cumpleanosList.innerHTML = filteredBirthdays.map(athlete => {
                        const birthDate = new Date(athlete.fechaNacimiento);
                        const day = birthDate.getDate();
                        const year = birthDate.getFullYear();
                        const age = new Date().getFullYear() - year;
                        
                        return `
                            <div class="flex items-center justify-between p-4 bg-white border-l-4 border-voley-gold shadow-lg rounded-lg transform transition duration-300 hover:shadow-xl">
                                <div class="flex items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-voley-gold mr-4 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M5.5 2a.5.5 0 00-.5.5v1a.5.5 0 00.5.5h1a.5.5 0 00.5-.5v-1a.5.5 0 00-.5-.5h-1zM9.5 2a.5.5 0 00-.5.5v1a.5.5 0 00.5.5h1a.5.5 0 00.5-.5v-1a.5.5 0 00-.5-.5h-1zM13.5 2a.5.5 0 00-.5.5v1a.5.5 0 00.5.5h1a.5.5 0 00.5-.5v-1a.5.5 0 00-.5-.5h-1zM19 4H1a1 1 0 00-1 1v10a1 1 0 001 1h18a1 1 0 001-1V5a1 1 0 00-1-1zm-1 9V6H2v7h16z" clip-rule="evenodd" />
                                        <path d="M12 9a1 1 0 100-2 1 1 0 000 2z" />
                                    </svg>
                                    <div>
                                        <p class="text-xl font-semibold text-gray-800">${athlete.nombre}</p>
                                        <p class="text-sm text-gray-500">Cumple ${age} a침os</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <span class="text-2xl font-bold text-voley-dark bg-voley-light px-3 py-1 rounded-full shadow-inner">${day}</span>
                                    <p class="text-xs text-gray-600 mt-1">${monthNames[currentMonth - 1]}</p>
                                </div>
                            </div>
                        `;
                    }).join('');
                    
                    loadingMessage.classList.add('hidden');
                } else {
                    loadingMessage.textContent = `No hay cumplea침os registrados para ${clubName} en ${monthNames[currentMonth - 1]}.`;
                    loadingMessage.classList.remove('hidden');
                }

            } catch (error) {
                console.error("Error al cargar los cumplea침os:", error);
                loadingMessage.textContent = "Error al cargar los datos. Revisa la consola o tu script de Firebase.";
                loadingMessage.style.color = 'red';
            }

            // --------------------------------------------------------------------------------
            // 游늷 FIN DE LA ZONA DE PERSONALIZACI칍N DE BASE DE DATOS
            // --------------------------------------------------------------------------------
        }
    </script>

</body>
</html>
